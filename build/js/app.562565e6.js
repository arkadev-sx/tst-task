(function(){"use strict";var t={453:function(t,e,n){var a=n(963),r=n(252),i=n(577);function o(t,e,n,a,o,s){const l=(0,r.up)("Home"),c=(0,r.up)("ContentArea");return(0,r.wg)(),(0,r.j4)(c,{class:(0,i.normalizeClass)("app__content-area")},{default:(0,r.w5)((()=>[(0,r.Wm)(l)])),_:1})}const s={class:(0,i.normalizeClass)("content-area")},l={class:(0,i.normalizeClass)("content-wrp")};function c(t,e,n,a,i,o){return(0,r.wg)(),(0,r.iD)("main",s,[(0,r._)("div",l,[(0,r.WI)(t.$slots,"default")])])}var u=(0,r.aZ)({name:"ContentArea"}),d=n(744);const m=(0,d.Z)(u,[["render",c]]);var p=m;const h={class:"home"},f={class:"home__box home__box_grid"},y={class:"home__box home__box_cart"};function v(t,e,n,a,i,o){const s=(0,r.up)("Popup"),l=(0,r.up)("Grid"),c=(0,r.up)("Cart");return(0,r.wg)(),(0,r.iD)("div",h,[(0,r.Wm)(s,{class:"home__popup"}),(0,r._)("div",f,[(0,r.Wm)(l)]),(0,r._)("div",y,[(0,r.Wm)(c)])])}var g=n(758);const _=(t,e)=>Math.random()*(e-t)+t;var I=_;const b=(t,e)=>{const n=Object.keys(e).reduce(((n,a)=>{const{G:r,B:i}=e[a],o=Object.keys(i).reduce(((e,n)=>{const{N:a}=i[n],r=t.find((t=>{let{T:e}=t;return e.toString()===n.toString()}));if(!r)return e;const{C:o,P:s}=r;return{...e,[n]:{name:a,priceUSD:o,quantity:s}}}),{});return{...n,[a]:{name:r,goods:o}}}),{});return n};var C=b;const D=async()=>{const t=await fetch("https://raw.githubusercontent.com/arkadev-sx/test-task_1/master/public/data.json"),e=await t.json();return e.Value.Goods},w=async()=>{const t=await fetch("https://raw.githubusercontent.com/arkadev-sx/test-task_1/master/public/names.json"),e=await t.json();return e},A=(0,g.Q_)("main",{state:()=>({exchangeRate:20,collection:{},cart:[]}),actions:{async updateAllData(){try{const t=await D(),e=await w();this.collection=C(t,e)}catch(t){throw new Error(t)}this.updateExchangeRate()},updateExchangeRate(){this.exchangeRate=I(20,80).toFixed(2)},updateItem(t,e,n){const a=this.findItem(t);if(a)0===n?this.removeItem(a):this.setItemQty(a,n);else{if(0===n)return;this.createItem(t,e,n)}},findItem(t){return this.cart.find((e=>e.itemID===t))},setItemQty(t,e){t.quantity=e},createItem(t,e,n){const a={itemID:t,categoryID:e,quantity:n};this.cart.push(a)},removeItem(t){const e=this.cart.indexOf(t);this.cart.splice(e,1)}}}),S={class:"goods-grid"};function V(t,e){const n=(0,r.up)("GridItem"),a=(0,r.up)("GridCategory");return(0,r.wg)(),(0,r.iD)("div",S,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.store.collection,((e,i)=>((0,r.wg)(),(0,r.j4)(a,{key:i,title:e.name,isEmptyBlock:0===Object.keys(e.goods).length},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.store.collection[i].goods,((t,e)=>((0,r.wg)(),(0,r.j4)(n,{key:e,catID:i,itemID:e,item:t},null,8,["catID","itemID","item"])))),128))])),_:2},1032,["title","isEmptyBlock"])))),128))])}const k={class:"category"},x={class:"category__title"},O=(0,r._)("div",{class:"icon"},null,-1),T=[O],q={class:"category__box"},Z={key:0,class:(0,i.normalizeClass)(["category__empty-notice"])};function j(t,e,n,a,o,s){const l=(0,r.up)("slide-up-down");return(0,r.wg)(),(0,r.iD)("div",k,[(0,r._)("div",x,[(0,r._)("div",{class:(0,i.normalizeClass)(["category__switch",{["folded"]:!t.isOpen,["empty"]:t.isEmptyBlock}]),onClick:e[0]||(e[0]=function(){return t.toggle&&t.toggle(...arguments)})},T,2),(0,r._)("span",{class:(0,i.normalizeClass)(["category__title-text",{["empty"]:t.isEmptyBlock}])},(0,i.toDisplayString)(t.title),3)]),(0,r._)("div",q,[(0,r.Wm)(l,{modelValue:t.isOpen,"onUpdate:modelValue":e[1]||(e[1]=e=>t.isOpen=e),duration:220,class:"category__fold"},{default:(0,r.w5)((()=>[t.isEmptyBlock?((0,r.wg)(),(0,r.iD)("div",Z," there is no availible goods for this category ")):(0,r.kq)("",!0),(0,r.WI)(t.$slots,"default")])),_:3},8,["modelValue"])])])}var E=n(936),z=(0,r.aZ)({name:"GridCategory",components:{SlideUpDown:E.Z},props:{title:{type:String,default:"Category Title"},isEmptyBlock:{type:Boolean,default:!0}},data(){return{isOpen:!1}},methods:{toggle(){this.isOpen?this.isOpen=!1:this.isOpen=!0}}});const P=(0,d.Z)(z,[["render",j]]);var B=P;const F={class:"item"},G={class:"item__title"},W={class:"item__quantity"};function U(t,e,n,a,o,s){const l=(0,r.up)("PriceFrame");return(0,r.wg)(),(0,r.iD)("div",F,[(0,r._)("div",G,(0,i.toDisplayString)(t.item.name),1),(0,r._)("div",W,(0,i.toDisplayString)(t.availibleAmountToAdd)+"шт.",1),(0,r.Wm)(l,{class:"item__price",currencySymbol:"₽",unitAlias:"шт.",price:t.currentPrice,colorize:!0},null,8,["unitAlias","price"]),(0,r._)("div",{class:(0,i.normalizeClass)(["item__add-btn",{["disabled"]:0===t.availibleAmountToAdd}]),onClick:e[0]||(e[0]=function(){return t.addToCartBtnHandler&&t.addToCartBtnHandler(...arguments)})}," add to cart ",2)])}function H(t,e,n,a,o,s){return(0,r.wg)(),(0,r.iD)("div",{class:"price-frame",style:(0,i.normalizeStyle)(`color: ${t.priceColor}`)},(0,i.toDisplayString)(t.price)+(0,i.toDisplayString)(t.currencySymbol)+"/"+(0,i.toDisplayString)(t.unitAlias),5)}var M=(0,r.aZ)({name:"PriceFrame",props:{price:{type:Number,default:0},currencySymbol:{type:String,default:"₽"},unitAlias:{type:String,default:"шт."},colorize:{type:Boolean,default:!1}},data(){return{priceColor:"quo",colors:{increase:"#ff5773",reduction:"#03a824",quo:"#ffffff"}}},watch:{price(t,e){this.colorize&&(this.priceColor=t>e?this.colors.increase:t<e?this.colors.reduction:this.colors.quo)}},methods:{}});const R=(0,d.Z)(M,[["render",H]]);var $=R,N=(0,r.aZ)({name:"GridItem",components:{PriceFrame:$},props:{item:{type:Object,default(){return{}}},catID:{type:String,default:"0"},itemID:{type:String,default:"0"}},setup(){const t=A(),e=t.findItem,{updateItem:n}=t;return{store:t,updateItem:n,findItemInCart:e}},computed:{currentPrice(){return+(this.item.priceUSD*this.store.exchangeRate).toFixed(2)},amountInCart(){const t=this.findItemInCart(this.itemID);return t?t.quantity:0},availibleAmountToAdd(){return this.item.quantity-this.amountInCart}},methods:{addToCartBtnHandler(){this.amountInCart>0?this.availibleAmountToAdd>0&&this.updateValue(this.amountInCart+1):0===this.amountInCart&&this.updateValue(1)},updateValue(t){this.updateItem(this.itemID,this.catID,t)}}});const K=(0,d.Z)(N,[["render",U]]);var L=K,Q=(0,r.aZ)({name:"GoodsGrid",components:{GridCategory:B,GridItem:L},setup(){const t=A();return{store:t}}});const Y=(0,d.Z)(Q,[["render",V]]);var J=Y;const X={class:"cart"},tt={class:(0,i.normalizeClass)(["summary"])};function et(t,e,n,o,s,l){const c=(0,r.up)("CartItem");return(0,r.wg)(),(0,r.iD)("div",X,[(0,r._)("div",tt,[(0,r._)("span",{class:(0,i.normalizeClass)(["summary__notice",{["visible"]:0===t.store.cart.length}])},"cart is empty",2),(0,r._)("div",{class:(0,i.normalizeClass)(["summary__inner",{["visible"]:t.store.cart.length>0}])}," Total price: "+(0,i.toDisplayString)(t.summary)+"₽ ",3)]),(0,r.Wm)(a.TransitionGroup,{tag:"div",name:"list",class:"cart__list"},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.store.cart,(t=>((0,r.wg)(),(0,r.j4)(c,{key:t.itemID,item:t,class:"list-item"},null,8,["item"])))),128))])),_:1})])}const nt={class:"cart-item"},at={class:"cart-item__title"};function rt(t,e,n,a,o,s){const l=(0,r.up)("PriceFrame"),c=(0,r.up)("ItemControls");return(0,r.wg)(),(0,r.iD)("div",nt,[(0,r._)("div",at,(0,i.toDisplayString)(t.itemInStore.name),1),(0,r.Wm)(l,{class:"cart-item__price",currencySymbol:"₽",unitAlias:"шт.",price:t.currentPrice,colorize:!1},null,8,["unitAlias","price"]),(0,r.Wm)(c,{class:"cart-item__controls",total:t.itemInStore.quantity,availibleAmountToAdd:t.availibleAmountToAdd,qtyInCart:t.item.quantity,onUpdate:t.updateValue},null,8,["total","availibleAmountToAdd","qtyInCart","onUpdate"]),(0,r._)("div",{class:(0,i.normalizeClass)(["cart-item__delete-btn",{["disabled"]:t.item.quantity<2}]),onClick:e[0]||(e[0]=e=>t.updateValue(0))}," delete ",2)])}const it={class:(0,i.normalizeClass)(["panel"])};function ot(t,e,n,a,o,s){const l=(0,r.up)("Field");return(0,r.wg)(),(0,r.iD)("div",it,[(0,r._)("div",{class:(0,i.normalizeClass)(["btn btn_shift",{["delete"]:1===t.qtyInCart,["disabled"]:0===t.qtyInCart}]),onClick:e[0]||(e[0]=e=>t.inputVal--)},null,2),(0,r.Wm)(l,{ref:"field",modelValue:t.inputVal,"onUpdate:modelValue":e[1]||(e[1]=e=>t.inputVal=e),modelModifiers:{trim:!0},class:(0,i.normalizeClass)(["panel__input",{["error"]:t.showError}]),type:"text",name:"qty",rules:t.validateInput,autocomplete:"off"},null,8,["modelValue","class","rules"]),(0,r._)("div",{class:(0,i.normalizeClass)(["btn btn_add",{["disabled"]:0===t.availibleAmountToAdd}]),onClick:e[2]||(e[2]=e=>t.inputVal++)},null,2)])}var st=n(954),lt=(0,r.aZ)({name:"ItemControls",components:{Field:st.gN},props:{total:{type:Number,default:1},availibleAmountToAdd:{type:Number,default:1},qtyInCart:{type:Number,default:1}},emits:["update"],data(){return{inputVal:0,showError:!1,processedValue:null}},watch:{processedValue(t){this.$emit("update",t)},qtyInCart(t){this.inputVal=t}},beforeMount(){this.inputVal=this.qtyInCart},methods:{validateInput(t){const e=/^\d+$/,n="0"===t[0]&&t.length>1,a=(t,e)=>!(t>e);e.test(t)?(n?(this.showError=!0,t[1]?this.inputVal=t.substr(1):this.inputVal=0):this.showError=!1,a(t,this.total)?this.showError=!1:(this.showError=!0,this.inputVal=this.total)):(this.showError=!0,this.inputVal=1),this.processedValue=Number(this.inputVal)}}});const ct=(0,d.Z)(lt,[["render",ot]]);var ut=ct,dt=(0,r.aZ)({name:"CartItem",components:{ItemControls:ut,PriceFrame:$},props:{item:{type:Object,default(){return{}}}},setup(){const t=A(),{updateItem:e}=t;return{store:t,updateItem:e}},computed:{itemInStore(){return this.store.collection[this.item.categoryID].goods[this.item.itemID]},availibleAmountToAdd(){return this.itemInStore.quantity-this.item.quantity},currentPrice(){return+(this.itemInStore.priceUSD*this.store.exchangeRate).toFixed(2)}},methods:{updateValue(t){this.updateItem(this.item.itemID,this.item.categoryID,t)}}});const mt=(0,d.Z)(dt,[["render",rt]]);var pt=mt,ht=(0,r.aZ)({name:"CartMain",components:{CartItem:pt},setup(){const t=A(),e=(0,r.Fl)((()=>{let e=0;return t.cart.forEach((n=>{const a=t.collection[n.categoryID].goods[n.itemID].priceUSD,r=a*n.quantity;e+=r})),(e*t.exchangeRate).toFixed(2).toString().replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1 ")}));return{store:t,summary:e}}});const ft=(0,d.Z)(ht,[["render",et]]);var yt=ft;const vt=(0,r._)("div",{class:"icon"},null,-1),gt=[vt];function _t(t,e,n,a,o,s){return(0,r.wg)(),(0,r.iD)("div",{class:(0,i.normalizeClass)(["popup",{["active"]:t.setupLocalData.popupIsVisible}])},gt,2)}var It=n(262),bt=(0,r.aZ)({name:"RefreshPopup",setup(t,e){const n=A();let a=(0,It.qj)({popupIsVisible:!1});e.expose({setupLocalData:a});const r=n.$onAction((t=>{let{name:e,after:n}=t;"updateAllData"===e&&n((()=>{a.popupIsVisible=!0,setTimeout((()=>{a.popupIsVisible=!1}),2500)}))}));return{mainStore:n,unsubscribe:r,setupLocalData:a}}});const Ct=(0,d.Z)(bt,[["render",_t]]);var Dt=Ct,wt=(0,r.aZ)({name:"HomePage",components:{Grid:J,Popup:Dt,Cart:yt},setup(){const t=A(),e=()=>t.updateAllData();return e(),{updateData:e}},data(){return{UPDATE_TIMEOIT:"15000",interval:0}},mounted(){this.interval=setInterval(this.updateData,this.UPDATE_TIMEOIT)},beforeUnmount(){clearInterval(this.interval)}});const At=(0,d.Z)(wt,[["render",v],["__scopeId","data-v-80b52966"]]);var St=At,Vt=(0,r.aZ)({name:"App",components:{ContentArea:p,Home:St},methods:{}});const kt=(0,d.Z)(Vt,[["render",o]]);var xt=kt,Ot=n(209),Tt=n.n(Ot);const qt=()=>{const t=(0,a.createApp)(xt);t.use((0,g.WB)()),t.use(Tt()),t.mount("#app")};qt()}},e={};function n(a){var r=e[a];if(void 0!==r)return r.exports;var i=e[a]={exports:{}};return t[a](i,i.exports,n),i.exports}n.m=t,function(){var t=[];n.O=function(e,a,r,i){if(!a){var o=1/0;for(u=0;u<t.length;u++){a=t[u][0],r=t[u][1],i=t[u][2];for(var s=!0,l=0;l<a.length;l++)(!1&i||o>=i)&&Object.keys(n.O).every((function(t){return n.O[t](a[l])}))?a.splice(l--,1):(s=!1,i<o&&(o=i));if(s){t.splice(u--,1);var c=r();void 0!==c&&(e=c)}}return e}i=i||0;for(var u=t.length;u>0&&t[u-1][2]>i;u--)t[u]=t[u-1];t[u]=[a,r,i]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,a){var r,i,o=a[0],s=a[1],l=a[2],c=0;if(o.some((function(e){return 0!==t[e]}))){for(r in s)n.o(s,r)&&(n.m[r]=s[r]);if(l)var u=l(n)}for(e&&e(a);c<o.length;c++)i=o[c],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(u)},a=self["webpackChunksx_test_task"]=self["webpackChunksx_test_task"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=n.O(void 0,[998],(function(){return n(453)}));a=n.O(a)})();