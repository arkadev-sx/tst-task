(function(){"use strict";var t={542:function(t,e,n){var a=n(963),r=n(252),i=n(577);function o(t,e,n,a,o,s){const l=(0,r.up)("Home"),u=(0,r.up)("ContentArea");return(0,r.wg)(),(0,r.j4)(u,{class:(0,i.normalizeClass)("app__content-area")},{default:(0,r.w5)((()=>[(0,r.Wm)(l)])),_:1})}const s={class:(0,i.normalizeClass)("content-area")},l={class:(0,i.normalizeClass)("content-wrp")};function u(t,e,n,a,i,o){return(0,r.wg)(),(0,r.iD)("main",s,[(0,r._)("div",l,[(0,r.WI)(t.$slots,"default")])])}var c=(0,r.aZ)({name:"ContentArea"}),d=n(744);const m=(0,d.Z)(c,[["render",u]]);var p=m;const h={class:"home"},f={class:"home__box home__box_grid"},v={class:"home__box home__box_cart"};function y(t,e,n,a,i,o){const s=(0,r.up)("Popup"),l=(0,r.up)("Grid"),u=(0,r.up)("Cart");return(0,r.wg)(),(0,r.iD)("div",h,[(0,r.Wm)(s,{class:"home__popup"}),(0,r._)("div",f,[(0,r.Wm)(l)]),(0,r._)("div",v,[(0,r.Wm)(u)])])}var g=n(758);const _=(t,e)=>Math.random()*(e-t)+t;var I=_;const b=(t,e)=>{const n=Object.keys(e).reduce(((n,a)=>{const{G:r,B:i}=e[a],o=Object.keys(i).reduce(((e,n)=>{const{N:a}=i[n],r=t.find((t=>{let{T:e}=t;return e.toString()===n.toString()}));if(!r)return e;const{C:o,P:s}=r;return{...e,[n]:{name:a,priceUSD:o,quantity:s}}}),{});return{...n,[a]:{name:r,goods:o}}}),{});return n};var C=b;const w=async()=>{const t=await fetch("https://raw.githubusercontent.com/arkadev-sx/dth/master/public/data.json"),e=await t.json();return e.Value.Goods},A=async()=>{const t=await fetch("https://raw.githubusercontent.com/arkadev-sx/dth/master/public/names.json"),e=await t.json();return e},D=(0,g.Q_)("main",{state:()=>({exchangeRate:20,collection:{},cart:[]}),actions:{async updateAllData(){try{const t=await w(),e=await A();this.collection=C(t,e)}catch(t){throw new Error(t)}this.updateExchangeRate()},updateExchangeRate(){this.exchangeRate=I(20,80).toFixed(2)},updateItemInCart(t){const e=this.findItemInCart(t.id);e?0===t.quantity?this.removeItemFromCart(t.id):this.setItemQtyInCart(e,t.quantity):t.quantity>0&&this.createItemInCart(t)},findItemInCart(t){return this.cart.find((e=>e.id===t))},setItemQtyInCart(t,e){t.quantity=e},createItemInCart(t){const e=this.cart;e.push(t)},removeItemFromCart(t){const e=this.cart.findIndex((e=>e.id===t));e>=0&&this.cart.splice(e,1)}}}),S={class:"goods-grid"};function V(t,e){const n=(0,r.up)("GridItem"),a=(0,r.up)("GridCategory");return(0,r.wg)(),(0,r.iD)("div",S,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.store.collection,((e,i)=>((0,r.wg)(),(0,r.j4)(a,{key:i,title:e.name,isEmptyBlock:0===Object.keys(e.goods).length},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.store.collection[i].goods,((t,e)=>((0,r.wg)(),(0,r.j4)(n,{key:e,catId:i,itemId:e,item:t},null,8,["catId","itemId","item"])))),128))])),_:2},1032,["title","isEmptyBlock"])))),128))])}const x={class:"category"},k=(0,r._)("div",{class:"icon"},null,-1),T=[k],q={class:"category__box"},O={key:0,class:(0,i.normalizeClass)(["category__empty-notice"])};function Z(t,e,n,a,o,s){const l=(0,r.up)("slide-up-down");return(0,r.wg)(),(0,r.iD)("div",x,[(0,r._)("div",{class:"category__title",onClick:e[0]||(e[0]=function(){return t.toggle&&t.toggle(...arguments)})},[(0,r._)("div",{class:(0,i.normalizeClass)(["category__switch",{["folded"]:!t.isOpen,["empty"]:t.isEmptyBlock}])},T,2),(0,r._)("span",{class:(0,i.normalizeClass)(["category__title-text",{["empty"]:t.isEmptyBlock}])},(0,i.toDisplayString)(t.title),3)]),(0,r._)("div",q,[(0,r.Wm)(l,{modelValue:t.isOpen,"onUpdate:modelValue":e[1]||(e[1]=e=>t.isOpen=e),duration:220,class:"category__fold"},{default:(0,r.w5)((()=>[t.isEmptyBlock?((0,r.wg)(),(0,r.iD)("div",O," there is no availible goods for this category ")):(0,r.kq)("",!0),(0,r.WI)(t.$slots,"default")])),_:3},8,["modelValue"])])])}var j=n(936),z=(0,r.aZ)({name:"GridCategory",components:{SlideUpDown:j.Z},props:{title:{type:String,default:"Category Title"},isEmptyBlock:{type:Boolean,default:!0}},data(){return{isOpen:!0}},beforeMount(){this.isEmptyBlock&&(this.isOpen=!1)},methods:{toggle(){this.isOpen?this.isOpen=!1:this.isOpen=!0}}});const P=(0,d.Z)(z,[["render",Z]]);var B=P;const E={class:"item"},F={class:"item__title"},G={class:"item__quantity"};function H(t,e,n,a,o,s){const l=(0,r.up)("PriceFrame");return(0,r.wg)(),(0,r.iD)("div",E,[(0,r._)("div",F,(0,i.toDisplayString)(t.item.name),1),(0,r._)("div",G,(0,i.toDisplayString)(t.availibleAmountToAdd)+"шт.",1),(0,r.Wm)(l,{class:"item__price",currencySymbol:"₽",unitAlias:"шт.",price:t.currentPrice,colorize:!0},null,8,["unitAlias","price"]),(0,r._)("div",{class:(0,i.normalizeClass)(["item__add-btn",{["disabled"]:0===t.availibleAmountToAdd}]),onClick:e[0]||(e[0]=function(){return t.addToCartBtnHandler&&t.addToCartBtnHandler(...arguments)})}," add to cart ",2)])}function U(t,e,n,a,o,s){return(0,r.wg)(),(0,r.iD)("div",{class:"price-frame",style:(0,i.normalizeStyle)(`color: ${t.priceColor}`)},(0,i.toDisplayString)(t.price)+(0,i.toDisplayString)(t.currencySymbol)+"/"+(0,i.toDisplayString)(t.unitAlias),5)}var W=(0,r.aZ)({name:"PriceFrame",props:{price:{type:Number,default:0},currencySymbol:{type:String,default:"₽"},unitAlias:{type:String,default:"шт."},colorize:{type:Boolean,default:!1}},data(){return{priceColor:"quo",colors:{increase:"#ff5773",reduction:"#03a824",quo:"#ffffff"}}},watch:{price(t,e){this.colorize&&(this.priceColor=t>e?this.colors.increase:t<e?this.colors.reduction:this.colors.quo)}},methods:{}});const M=(0,d.Z)(W,[["render",U]]);var R=M,N=(0,r.aZ)({name:"GridItem",components:{PriceFrame:R},props:{item:{type:Object,default(){return{}}},catId:{type:String,default:"0"},itemId:{type:String,default:"0"}},setup(){const t=D(),{findItemInCart:e}=t,{updateItemInCart:n}=t;return{store:t,updateItemInCart:n,findItemInCart:e}},computed:{currentPrice(){return+(this.item.priceUSD*this.store.exchangeRate).toFixed(2)},amountInCart(){const t=this.findItemInCart(this.itemId);return t?t.quantity:0},availibleAmountToAdd(){return this.item.quantity-this.amountInCart}},methods:{addToCartBtnHandler(){this.amountInCart>0?this.availibleAmountToAdd>0&&this.updateValue(this.amountInCart+1):0===this.amountInCart&&this.updateValue(1)},updateValue(t){const e={id:this.itemId,categoryId:this.catId,quantity:t};this.updateItemInCart(e)}}});const $=(0,d.Z)(N,[["render",H]]);var K=$,L=(0,r.aZ)({name:"GoodsGrid",components:{GridCategory:B,GridItem:K},setup(){const t=D();return{store:t}}});const Q=(0,d.Z)(L,[["render",V]]);var Y=Q;const J={class:"cart"},X={class:(0,i.normalizeClass)(["summary"])};function tt(t,e,n,o,s,l){const u=(0,r.up)("CartItem");return(0,r.wg)(),(0,r.iD)("div",J,[(0,r._)("div",X,[(0,r._)("span",{class:(0,i.normalizeClass)(["summary__notice",{["visible"]:0===t.store.cart.length}])},"cart is empty",2),(0,r._)("div",{class:(0,i.normalizeClass)(["summary__inner",{["visible"]:t.store.cart.length>0}])}," Total price: "+(0,i.toDisplayString)(t.summary)+"₽ ",3)]),(0,r.Wm)(a.TransitionGroup,{tag:"div",name:"list",class:"cart__list"},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.store.cart,(t=>((0,r.wg)(),(0,r.j4)(u,{key:t.id,item:t,class:"list-item"},null,8,["item"])))),128))])),_:1})])}const et={class:"cart-item"},nt={class:"cart-item__title"};function at(t,e,n,a,o,s){const l=(0,r.up)("PriceFrame"),u=(0,r.up)("ItemControls");return(0,r.wg)(),(0,r.iD)("div",et,[(0,r._)("div",nt,(0,i.toDisplayString)(t.itemInGoodsList.name),1),(0,r.Wm)(l,{class:"cart-item__price",currencySymbol:"₽",unitAlias:"шт.",price:t.currentPrice,colorize:!1},null,8,["unitAlias","price"]),(0,r.Wm)(u,{class:"cart-item__controls",total:t.itemInGoodsList.quantity,availibleAmountToAdd:t.availibleAmountToAdd,qtyInCart:t.item.quantity,onUpdate:t.updateValue},null,8,["total","availibleAmountToAdd","qtyInCart","onUpdate"]),(0,r._)("div",{class:(0,i.normalizeClass)(["cart-item__delete-btn",{["disabled"]:t.item.quantity<2}]),onClick:e[0]||(e[0]=e=>t.updateValue(0))}," delete ",2)])}var rt=n(262);const it={class:(0,i.normalizeClass)(["panel"])};function ot(t,e,n,o,s,l){return(0,r.wg)(),(0,r.iD)("div",it,[(0,r._)("div",{class:(0,i.normalizeClass)(["btn btn_shift",{["delete"]:1===t.qtyInCart,["disabled"]:0===t.qtyInCart}]),onClick:e[0]||(e[0]=e=>t.buttonHandle("decrement"))},null,2),(0,r.wy)((0,r._)("input",{ref:"field","onUpdate:modelValue":e[1]||(e[1]=e=>t.inputVal=e),type:"text",class:(0,i.normalizeClass)(["panel__input",{["error"]:t.showError}]),name:"qty",autocomplete:"off",onInput:e[2]||(e[2]=function(){return t.validateInput&&t.validateInput(...arguments)}),onBlur:e[3]||(e[3]=function(){return t.validateBlur&&t.validateBlur(...arguments)})},null,34),[[a.vModelText,t.inputVal,void 0,{trim:!0}]]),(0,r._)("div",{class:(0,i.normalizeClass)(["btn btn_add",{["disabled"]:0===t.availibleAmountToAdd}]),onClick:e[4]||(e[4]=e=>t.buttonHandle("increment"))},null,2)])}var st=(0,r.aZ)({name:"ItemControls",props:{total:{type:Number,default:1},availibleAmountToAdd:{type:Number,default:1},qtyInCart:{type:Number,default:1}},emits:["update"],data(){return{inputVal:0,showError:!1,processedValue:null}},watch:{processedValue(t){this.$emit("update",t)},qtyInCart(t){this.inputVal=t}},beforeMount(){this.inputVal=this.qtyInCart},methods:{buttonHandle(t){"increment"===t&&this.inputVal++,"decrement"===t&&this.inputVal--,this.processedValue=this.inputVal},validateValueRegex(t){const e=t.toString(),n=e.replace(/[^0-9]/g,""),a=n.length>1?n.replace(/^0+/,""):n;return a},validateBlur(t){const e=t.target.value?t.target.value:0;this.inputVal=Number(e),this.processedValue=this.inputVal},validateInput(t){const e=Number(this.validateValueRegex(t.target.value));this.inputVal=e>this.total?this.total:e,e>0&&(this.processedValue=this.inputVal)}}});const lt=(0,d.Z)(st,[["render",ot]]);var ut=lt,ct=(0,r.aZ)({name:"CartItem",components:{ItemControls:ut,PriceFrame:R},props:{item:{type:Object,default(){return{}}}},setup(t){const e=D(),{updateItemInCart:n}=e,{item:a}=(0,rt.BK)(t),i=(0,r.Fl)((()=>e.collection[a.value.categoryId].goods[a.value.id])),o=(0,r.Fl)((()=>i.value.quantity-a.value.quantity)),s=(0,r.Fl)((()=>+(i.value.priceUSD*e.exchangeRate).toFixed(2)));return{store:e,updateItemInCart:n,itemInGoodsList:i,availibleAmountToAdd:o,currentPrice:s}},methods:{updateValue(t){const e={...this.item,quantity:t};this.updateItemInCart(e)}}});const dt=(0,d.Z)(ct,[["render",at]]);var mt=dt,pt=(0,r.aZ)({name:"CartMain",components:{CartItem:mt},setup(){const t=D(),e=(0,r.Fl)((()=>{let e=0;return t.cart.forEach((n=>{const a=t.collection[n.categoryId].goods[n.id].priceUSD,r=a*n.quantity;e+=r})),(e*t.exchangeRate).toFixed(2).toString().replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1 ")}));return{store:t,summary:e}}});const ht=(0,d.Z)(pt,[["render",tt]]);var ft=ht;const vt=(0,r._)("div",{class:"icon"},null,-1),yt=[vt];function gt(t,e,n,a,o,s){return(0,r.wg)(),(0,r.iD)("div",{class:(0,i.normalizeClass)(["popup",{["active"]:t.popupIsVisible}])},yt,2)}var _t=(0,r.aZ)({name:"RefreshPopup",setup(){const t=D(),e=(0,rt.iH)(!1),n=t.$onAction((t=>{let{name:n,after:a}=t;"updateAllData"===n&&a((()=>{e.value=!0,setTimeout((()=>{e.value=!1}),2500)}))}));return{unsubscribe:n,popupIsVisible:e}},beforeUnmount(){this.unsubscribe()}});const It=(0,d.Z)(_t,[["render",gt]]);var bt=It,Ct=(0,r.aZ)({name:"HomePage",components:{Grid:Y,Popup:bt,Cart:ft},setup(){const t=D(),e=t.updateAllData;return(0,r.bv)(e),{updateData:e}},data(){return{UPDATE_TIMEOIT:"15000",interval:0}},mounted(){this.interval=setInterval(this.updateData,this.UPDATE_TIMEOIT)},beforeUnmount(){clearInterval(this.interval)}});const wt=(0,d.Z)(Ct,[["render",y],["__scopeId","data-v-69f7fb86"]]);var At=wt,Dt=(0,r.aZ)({name:"App",components:{ContentArea:p,Home:At},methods:{}});const St=(0,d.Z)(Dt,[["render",o]]);var Vt=St,xt=n(209),kt=n.n(xt);const Tt=()=>{const t=(0,a.createApp)(Vt);t.use((0,g.WB)()),t.use(kt()),t.mount("#app")};Tt()}},e={};function n(a){var r=e[a];if(void 0!==r)return r.exports;var i=e[a]={exports:{}};return t[a](i,i.exports,n),i.exports}n.m=t,function(){var t=[];n.O=function(e,a,r,i){if(!a){var o=1/0;for(c=0;c<t.length;c++){a=t[c][0],r=t[c][1],i=t[c][2];for(var s=!0,l=0;l<a.length;l++)(!1&i||o>=i)&&Object.keys(n.O).every((function(t){return n.O[t](a[l])}))?a.splice(l--,1):(s=!1,i<o&&(o=i));if(s){t.splice(c--,1);var u=r();void 0!==u&&(e=u)}}return e}i=i||0;for(var c=t.length;c>0&&t[c-1][2]>i;c--)t[c]=t[c-1];t[c]=[a,r,i]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,a){var r,i,o=a[0],s=a[1],l=a[2],u=0;if(o.some((function(e){return 0!==t[e]}))){for(r in s)n.o(s,r)&&(n.m[r]=s[r]);if(l)var c=l(n)}for(e&&e(a);u<o.length;u++)i=o[u],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(c)},a=self["webpackChunksx_test_task"]=self["webpackChunksx_test_task"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=n.O(void 0,[998],(function(){return n(542)}));a=n.O(a)})();